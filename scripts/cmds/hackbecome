const fs = require("fs");
const path = "./hackers.json";

// Fonction pour lire le fichier des hackeurs
function getHackers() {
  if (!fs.existsSync(path)) return {};
  return JSON.parse(fs.readFileSync(path));
}

// Fonction pour sauvegarder les hackeurs
function saveHackers(data) {
  fs.writeFileSync(path, JSON.stringify(data, null, 2));
}

module.exports = {
  config: {
    name: "hackbecome",
    version: "1.0",
    author: "L'Uchiha Perdu",
    role: 0,
    shortDescription: "Devenir hackeur",
    longDescription: "RÃ©pondez correctement aux 3 questions pour devenir hackeur.",
    category: "hacking"
  },

  onStart: async function ({ message, event, args }) {
    const senderID = event.senderID;
    let hackers = getHackers();

    if (hackers[senderID]) return message.reply("ğŸ˜ Vous Ãªtes dÃ©jÃ  hackeur !");

    // Liste des questions et rÃ©ponses
    const questions = [
      { question: "Combien font 987 x 123 ?", answer: "121401" },
      { question: "Quel est le systÃ¨me d'exploitation basÃ© sur Linux ?", answer: "Ubuntu" },
      { question: "Qui est le crÃ©ateur de l'univers ?", answer: "L'Uchiha Perdu" }
    ];

    // Si aucune rÃ©ponse n'est fournie
    if (!args[0]) {
      return message.reply(`ğŸ•µï¸ RÃ©pondez aux 3 questions pour devenir hackeur.\n\n${questions[0].question}\n\nRÃ©pondez avec : /hackbecome [rÃ©ponse]`);
    }

    // VÃ©rifier la rÃ©ponse
    let progress = hackers[senderID] ? hackers[senderID].progress : 0;
    if (args.join(" ").toLowerCase() === questions[progress].answer.toLowerCase()) {
      progress++;
      hackers[senderID] = { progress };
      saveHackers(hackers);

      if (progress === questions.length) {
        message.reply("ğŸ‰ Parfait ! Vous Ãªtes maintenant un hackeur officiel !");
        hackers[senderID] = { progress: "hackeur" };
        saveHackers(hackers);
      } else {
        message.reply(`âœ… Correct ! Prochaine question :\n\n${questions[progress].question}\n\nRÃ©pondez avec : /hackbecome [rÃ©ponse]`);
      }
    } else {
      message.reply("âŒ Mauvaise rÃ©ponse ! Essayez encore.");
    }
  }
};